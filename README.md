# Высокочастотный Арбитражный Крипто-Робот (v2.0)

Этот проект представляет собой торгового робота для поиска и фиксации арбитражных возможностей между криптовалютными биржами OKX и Bybit. Проект прошел несколько стадий глубокого рефакторинга и оптимизации.

## Текущий Статус: Режим "Черного Ящика" (Black Box Diagnostic)

После исчерпывающего анализа и нескольких итераций исправлений, направленных на поиск причин отсутствия сделок, робот был переведен в финальный диагностический режим.

**Цель текущего режима:** Сбор "сырых" рыночных данных для окончательного ответа на вопрос о жизнеспособности арбитражной стратегии между OKX и Bybit на выбранных парах. Робот в этом режиме не пытается найти прибыльные сделки, а лишь с максимальной частотой записывает состояние рынка в специальный лог-файл `market_state.log`.

## Ключевые улучшения и внедренные функции

За время работы над проектом были внедрены следующие профессиональные функции:

- **Продвинутая симуляция портфеля:** Робот отслеживал виртуальные балансы на обеих биржах и принимал решения о сделках только при наличии достаточных средств.
- **Динамический порог прибыльности:** Был реализован механизм, который адаптирует минимальный порог прибыли в зависимости от текущей волатильности рынка.
- **Симуляция ребалансировки:** Модуль портфеля умел симулировать перемещение активов между биржами для предотвращения их исчерпания.
- **Защита от "протухших" данных:** Внедрен критически важный механизм, который отбрасывает рыночные данные, если они не синхронизированы между биржами в пределах заданного временного окна (например, 0.5 секунды).
- **Централизованное логирование:** Все `print` вызовы заменены на профессиональный логгер, который пишет структурированную информацию в `robot.log` и `paper_trades.log`.
- **Безопасная конфигурация:** API-ключи вынесены из кода в переменные окружения, что является стандартом безопасности.
- **Оптимизация производительности:** Основной цикл анализа был оптимизирован для отсеивания бесперспективных тиков на раннем этапе, что значительно снижает нагрузку на CPU.

## Как использовать (в текущем режиме "Черного Ящика")

1.  **Клонирование репозитория:**
    ```bash
    git clone https://github.com/richi8588/CRYPTO_ROBOT.git
    cd CRYPTO_ROBOT
    ```

2.  **Создание и активация виртуального окружения:**
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```

3.  **Установка зависимостей:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Конфигурация (Опционально для текущего режима):**
    Настройте переменные окружения. Для режима "Черного ящика" это не обязательно, но понадобится для следующих этапов.
    ```bash
    export BYBIT_API_KEY="ВАШ_КЛЮЧ_BYBIT"
    export BYBIT_API_SECRET="ВАШ_СЕКРЕТ_BYBIT"
    # ... и так далее для OKX
    ```

5.  **Запуск диагностики:**
    Запустите робота в фоновом режиме. Рекомендуется дать ему поработать 5-15 минут.
    ```bash
    nohup python3 live_trader.py &
    ```

6.  **Анализ результатов:**
    Изучите содержимое нового лог-файла `market_state.log`.
    ```bash
    tail -f market_state.log
    ```
    Обращайте внимание на колонки `Spread`. Если их значения стабильно отрицательные, это доказывает, что рынок слишком эффективен для данной стратегии.

## Дальнейшие шаги

1.  **Анализ данных из "Черного ящика":** Принять окончательное решение о жизнеспособности стратегии на текущих рынках.
2.  **Возврат к торговому режиму:** Если анализ покажет наличие возможностей, необходимо будет отключить диагностический режим и вернуть логику симуляции портфеля и принятия решений.
3.  **Исследование других рынков:** В случае неэффективности текущей стратегии, можно перенастроить робота на:
    *   Менее ликвидные торговые пары.
    *   Другие биржи (например, DEX или биржи второго эшелона), где неэффективности встречаются чаще.